# 2016-12-02工作日志

标签（空格分隔）： 2016年工作日志

---

### 字符串获取子字符串个数的方法

``` java
public static int getOccur(String src, String find) {
    int o = 0;
    int index = -1;
    while ((index = src.indexOf(find, index)) > -1) {
        ++index;
        ++o;
    }
    return o;
}
```

### HttpClient终止请求

由于我们业务需要用到阿里云转码的功能，但是对于大的视频转码需要一定时间，阿里云提供了轮训接口和消息下发两种解决方案，消息下发还需要接mns比较麻烦，还是使用老土的轮训方案吧~

``` java
// 需要视频在转码，但还是可以生成URL，我们只需要定时请求这个URL获取响应码即可
CloseableHttpClient httpclient = HttpClients.createDefault();
HttpGet httpget = new HttpGet(url_1080);
CloseableHttpResponse response = httpclient.execute(httpget);
int code = 0;
try {
    StatusLine status = response.getStatusLine();
    code = status.getStatusCode();
    httpget.abort();
} finally {
    response.close();
}
// 只有在200的时候才认为是转码成功了，才可以进行后续操作
if (code != 200) {
    continue;
}
```